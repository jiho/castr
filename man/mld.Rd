% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mld.R
\name{mld}
\alias{mld}
\title{Detect the depth of the mixed layer}
\usage{
mld(x, depth, ref.depths = 5:10, criteria = c(0.03, 0.01),
  default.depth = NA, n.smooth = 0, k = 2, ...)
}
\arguments{
\item{x}{vector of the variable of interest, usually potential or in situ density.}

\item{depth}{vector of depths at which \code{x} is measured; optional.}

\item{ref.depths}{depth(s) of reference, near the surface; when \code{ref.depths} is a vector, the value of \code{x} is averaged between those depths.}

\item{criteria}{value(s) considered as thresholds for the computation of the depth of the mixed layer. The thresholds are tried successively.}

\item{default.depth}{when no threshold is crossed, return this value instead; a usual value is the full depth of the water column (or \code{max(depth)}).}

\item{n.smooth}{integer, number of times to smooth the data before applying the mixed layer criteria.}

\item{k}{order of the moving average used for smoothing; the window size is 2k+1. NB: when data is smoothed, it should have been recorded at approximately regular intervals for the moving average to make sense.}

\item{...}{not used.}
}
\value{
If no criterion is met, return \code{default.depth}. If a criterion is met return the last depth at which it was not.
}
\description{
Detect the depth of the mixed layer
}
\details{
The mixed layer depth (MLD) is detected following de Boyer Montegut et al (2004): a reference value for density is taken near the surface and the water column is considered to be mixed until the depth at which density deviates from this refence by more than 0.03 kg/m^3. Optionally, when no depth satisfies this criterion, a second criterion of 0.01 kg/m^3 can be considered (as is by default).

In addition, here, when a range of depths is provided as reference, the refence density is the average of the densities recorded in this depth range.
}
\examples{
plot(-depth ~ sigma, data=d, type="l")
# compute mixed layer depth
MLD <- mld(d$sigma, d$depth)
abline(h=-MLD, col="red")
# compare with pycnocline
pycnocline <- clined(d$sigma, d$depth)
abline(h=-pycnocline, col="blue")
}
\references{
de Boyer Montegut et al (2004). Mixed layer depth over the global ocean: An examination of profile data and a profile‐based climatology. Journal of Geophysical Research: Oceans, 109(C12). \url{https://doi.org/10.1029/2004JC002378}
}
